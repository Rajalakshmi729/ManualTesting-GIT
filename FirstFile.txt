Verified the code added few comments go ahead and modify accordingly.
added few changes
